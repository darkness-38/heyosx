import { Button, VerticalBox, LineEdit, ComboBox } from "std-widgets.slint";

export component AppWindow inherits Window {
    width: 1920px;
    height: 1080px;
    title: "heyOS Greeter";
    no-frame: true;
    background: transparent;
    default-font-family: "Noto Sans";

    callback login(string, string, string);

    // Teto Theme Colors
    property <color> teto-crimson: #d53a47;
    property <color> teto-cyan: #4bb3d3;
    property <color> bg-dark: #121217;
    property <color> glass-bg: #1c1c24e6;

    in property <[string]> users: ["hamza"];
    in property <[string]> sessions: ["heydm", "plasma"];
    out property <string> selected-user: users[0];
    out property <string> selected-session: sessions[0];
    
    // Background Animation Setup
    Rectangle {
        width: 100%;
        height: 100%;
        background: @linear-gradient(135deg, bg-dark 0%, #1a151b 50%, bg-dark 100%);
        
        // Subtle animated twin drills / swooshes
        Path {
            stroke: teto-crimson.with-alpha(0.05);
            stroke-width: 200px;
            MoveTo { x: -100; y: -100; }
            CubicTo { control-1-x: 500; control-1-y: 800; control-2-x: 1400; control-2-y: 200; x: 2000; y: 1200; }
        }
        Path {
            stroke: teto-cyan.with-alpha(0.03);
            stroke-width: 150px;
            MoveTo { x: 2000; y: -100; }
            CubicTo { control-1-x: 1400; control-1-y: 800; control-2-x: 500; control-2-y: 200; x: -100; y: 1200; }
        }
    }

    // Main Login Card
    Rectangle {
        width: 400px;
        height: 500px;
        background: glass-bg;
        border-radius: 20px;
        border-width: 2px;
        border-color: teto-crimson.with-alpha(0.3);
        drop-shadow-blur: 40px;
        drop-shadow-color: #00000080;

        // Entry animation
        y: -50px;
        opacity: 0;
        animate y { duration: 800ms; easing: ease-out; }
        animate opacity { duration: 800ms; easing: ease-in-out; }
        init => {
            self.y = parent.height / 2 - 250px;
            self.opacity = 1;
        }

        VerticalBox {
            padding: 40px;
            spacing: 25px;
            alignment: center;

            Text {
                text: "heyOS";
                font-size: 36px;
                font-weight: 800;
                color: teto-crimson;
                horizontal-alignment: center;
            }
            
            Text {
                text: "Welcome back";
                font-size: 16px;
                color: white.with-alpha(0.6);
                horizontal-alignment: center;
            }

            ComboBox {
                model: root.users;
                current-value: root.selected-user;
                selected(val) => { root.selected-user = val; }
                height: 45px;
            }

            ComboBox {
                model: root.sessions;
                current-value: root.selected-session;
                selected(val) => { root.selected-session = val; }
                height: 45px;
            }

            pwd := LineEdit {
                placeholder-text: "Password...";
                input-type: password;
                height: 45px;
                font-size: 16px;
                accepted => { root.login(root.selected-user, self.text, root.selected-session); }
            }

            login_btn := Rectangle {
                height: 50px;
                background: touch.pressed ? teto-crimson.darker(0.2) : (touch.has-hover ? teto-crimson.brighter(0.2) : teto-crimson);
                border-radius: 10px;
                animate background { duration: 200ms; }

                Text {
                    text: "Log In";
                    color: white;
                    font-size: 18px;
                    font-weight: 700;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }

                touch := TouchArea {
                    clicked => { root.login(root.selected-user, pwd.text, root.selected-session); }
                }
            }
        }
    }
}
